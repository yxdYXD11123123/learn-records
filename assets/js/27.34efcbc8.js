(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{564:function(t,a,v){t.exports=v.p+"assets/img/image-20240307164846734.b61b734c.png"},565:function(t,a,v){t.exports=v.p+"assets/img/image-20240307165034258.a60544c9.png"},566:function(t,a,v){t.exports=v.p+"assets/img/image-20240307165331387.b9afbb9c.png"},567:function(t,a,v){t.exports=v.p+"assets/img/image-20240307165641958.24d33614.png"},568:function(t,a,v){t.exports=v.p+"assets/img/image-20240307165824543.47855a25.png"},569:function(t,a,v){t.exports=v.p+"assets/img/image-20240307170943555.ba19b2e6.png"},570:function(t,a,v){t.exports=v.p+"assets/img/image-20240307171903619.34aa1393.png"},571:function(t,a,v){t.exports=v.p+"assets/img/image-20240307171952428.e137cfd7.png"},572:function(t,a,v){t.exports=v.p+"assets/img/image-20240307172118095.b838aa4e.png"},573:function(t,a,v){t.exports=v.p+"assets/img/image-20240307172221524.f4e2843d.png"},661:function(t,a,v){"use strict";v.r(a);var _=v(14),r=Object(_.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"网际控制报文协议icmp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网际控制报文协议icmp"}},[t._v("#")]),t._v(" 网际控制报文协议ICMP")]),t._v(" "),a("ul",[a("li",[t._v("为了更有效地转发IP数据报和提供交付成功的机会，在网际层使用了网际控制报文协议ICMP（Internet Control Message Protocol）")]),t._v(" "),a("li",[t._v("主机或路由器使用ICMP来发送"),a("font",{attrs:{color:"#EA0000"}},[t._v("差错报告报文")]),t._v("和"),a("font",{attrs:{color:"#EA0000"}},[t._v("询问报文")])],1),t._v(" "),a("li",[a("font",{attrs:{color:"#EA0000"}},[t._v("ICMP报文被封装在IP数据报")]),t._v("中发送")],1)]),t._v(" "),a("h2",{attrs:{id:"icmp-差错报文报文共有以下五种"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#icmp-差错报文报文共有以下五种"}},[t._v("#")]),t._v(" ICMP 差错报文报文共有以下五种")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("终点不可达")]),t._v(" "),a("p",[t._v("当路由器或主机不能交付数据报时，就向源点发送终点不可达报文。具体可再根据ICMP的代码字段细分为目的网络不可达、目的主机不可达、目的协议不可达、目的端口不可达、目的网络未知、目的主机未知等13种错误")]),t._v(" "),a("p",[a("img",{attrs:{src:v(564),alt:"image-20240307164846734"}})])]),t._v(" "),a("li",[a("p",[t._v("源点抑制")]),t._v(" "),a("p",[t._v("当路由器或主机由于拥塞而丢弃数据报时，就向源点发送源点抑制报文，使源点知道应当把数据报的发送速率放慢")]),t._v(" "),a("p",[a("img",{attrs:{src:v(565),alt:"image-20240307165034258"}})])]),t._v(" "),a("li",[a("p",[t._v("时间超过")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("当路由器收到一个目的IP地址不是自己的IP数据报，会将其生存时间TTL字段的值减 1")]),t._v(" "),a("p",[t._v("若结果不为0，则将该IP数据报转发出去；若结果为0，除丢弃该IP数据报外，还要向源点发送时间超过报文")]),t._v(" "),a("p",[a("img",{attrs:{src:v(566),alt:"image-20240307165331387"}})])]),t._v(" "),a("li",[a("p",[t._v("另外，当终点在预先规定的时间内不能收到一个数据报的全部数据报文时，就把已收到的数据报文都丢弃，也会向源点发送时间超过报文。")])])])]),t._v(" "),a("li",[a("p",[t._v("参数问题")]),t._v(" "),a("p",[t._v("当路由器或目的主机收到IP数据报后，根据其首部中的检验和字段发现首部在传输过程中出现了误码，就丢弃该数据报，并向源点发送参数问题报文")]),t._v(" "),a("p",[a("img",{attrs:{src:v(567),alt:"image-20240307165641958"}})])]),t._v(" "),a("li",[a("p",[t._v("改变路由（重定向）")]),t._v(" "),a("p",[t._v("路由器把改变路由报文发送给主机，让主机知道下次应将数据报发送给另外的路由器（可通过更好的路由）")]),t._v(" "),a("p",[a("img",{attrs:{src:v(568),alt:"image-20240307165824543"}})])])]),t._v(" "),a("h4",{attrs:{id:"注意"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[t._v("#")]),t._v(" 注意")]),t._v(" "),a("p",[t._v("以下情况"),a("font",{attrs:{color:"#EA0000"}},[t._v("不应发送ICMP差错报文")]),t._v("：")],1),t._v(" "),a("ul",[a("li",[t._v("对ICMP差错报告不再发送ICMP差错报告报文")]),t._v(" "),a("li",[t._v("对第一个分片的数据报片的所有后续数据报文不发送ICMP差错报告报文")]),t._v(" "),a("li",[t._v("对具有多播地址的数据报都不发送ICMP差错报告报文")]),t._v(" "),a("li",[t._v("对具有特殊地址（如127.0.0.0或0.0.0.0）的数据报不发送ICMP差错报告报文")])]),t._v(" "),a("h2",{attrs:{id:"常用的icmp询问报文"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用的icmp询问报文"}},[t._v("#")]),t._v(" 常用的ICMP询问报文")]),t._v(" "),a("p",[t._v("有以下两种：")]),t._v(" "),a("ul",[a("li",[a("p",[a("font",{attrs:{color:"#EA0000"}},[t._v("回送请求和回答")])],1),t._v(" "),a("p",[t._v("ICMP回送请求报文是由主机或路由器向一个特定的目的主机发出的询问")]),t._v(" "),a("p",[t._v("收到此报文的主机必须给源主机或路由器发送ICMP回送回答报文")]),t._v(" "),a("p",[t._v("这种询问报文用来"),a("font",{attrs:{color:"#EA0000"}},[t._v("测试目的站是否可达")]),t._v("及了解其有关状态。")],1)]),t._v(" "),a("li",[a("p",[a("font",{attrs:{color:"#EA0000"}},[t._v("时间戳请求和回答")])],1),t._v(" "),a("p",[t._v("ICMP时间戳请求报文是请某个主机或路由器回答当前的日期和时间")]),t._v(" "),a("p",[t._v("在ICMP时间戳回答报文中有一个32位的字段，其中写入的整数代表从1900年1月1日起到当前时刻一共有多少秒。")]),t._v(" "),a("p",[t._v("这种询问报文用来"),a("font",{attrs:{color:"#EA0000"}},[t._v("进行时钟同步和测量时间")])],1)])]),t._v(" "),a("h2",{attrs:{id:"icmp应用举例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#icmp应用举例"}},[t._v("#")]),t._v(" ICMP应用举例")]),t._v(" "),a("h3",{attrs:{id:"分组网间探测ping-packet-internet-groper"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#分组网间探测ping-packet-internet-groper"}},[t._v("#")]),t._v(" 分组网间探测PING（Packet InterNet Groper）")]),t._v(" "),a("ul",[a("li",[t._v("用来测试主机或路由器间的连通性")]),t._v(" "),a("li",[t._v("应用层直接使用网际层的ICMP（没有通过运输层的TCP或UDP）")]),t._v(" "),a("li",[t._v("使用ICMP回送请求和回答报文")])]),t._v(" "),a("p",[a("img",{attrs:{src:v(569),alt:"image-20240307170943555"}})]),t._v(" "),a("h3",{attrs:{id:"跟踪路由-trace-route"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#跟踪路由-trace-route"}},[t._v("#")]),t._v(" 跟踪路由 （trace route）")]),t._v(" "),a("ul",[a("li",[t._v("用来测试IP数据报从源主机达到目的主机要经过哪些路由器")]),t._v(" "),a("li",[t._v("Windows版本\n"),a("ul",[a("li",[a("code",[t._v("tracert")]),t._v("命令")]),t._v(" "),a("li",[t._v("应用层直接使用网际层ICMP")]),t._v(" "),a("li",[t._v("使用了ICMP回送请求和回答报文以及差错报告报文")])])]),t._v(" "),a("li",[t._v("Unix版本\n"),a("ul",[a("li",[a("code",[t._v("traceroute")]),t._v(" 命令")]),t._v(" "),a("li",[t._v("在运输层使用UDP协议")]),t._v(" "),a("li",[t._v("仅使用ICMP差错报告报文")])])])]),t._v(" "),a("h4",{attrs:{id:"trace-route-原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#trace-route-原理"}},[t._v("#")]),t._v(" trace route 原理")]),t._v(" "),a("p",[t._v("先发送一个生存时间为1的ICMP回送请求")]),t._v(" "),a("p",[a("img",{attrs:{src:v(570),alt:"image-20240307171903619"}})]),t._v(" "),a("p",[t._v("经过R1时，生存时间归0，返回ICMP差错报告")]),t._v(" "),a("p",[a("img",{attrs:{src:v(571),alt:"image-20240307171952428"}})]),t._v(" "),a("p",[t._v("H1就知道了到达H2的路径中的第一个路由器为R1；")]),t._v(" "),a("p",[t._v("H1继续发送下一个生存时间为2的ICMP回送请求")]),t._v(" "),a("p",[a("img",{attrs:{src:v(572),alt:"image-20240307172118095"}})]),t._v(" "),a("p",[t._v("H1就知道了到达H2的路径中的第二个路由器为R2；")]),t._v(" "),a("p",[t._v("以此类推，直到H1收到H2的ICMP回送请求的回答报文：")]),t._v(" "),a("p",[a("img",{attrs:{src:v(573),alt:"image-20240307172221524"}})]),t._v(" "),a("p",[t._v("H1就知道已经跟踪到路径中的最后一站，即目的主机")])])}),[],!1,null,null,null);a.default=r.exports}}]);