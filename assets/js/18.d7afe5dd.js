(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{603:function(v,_,p){v.exports=p.p+"assets/img/image-20240306184720160.56e942dd.png"},604:function(v,_,p){v.exports=p.p+"assets/img/image-20240306190328568.0a9fd8f1.png"},605:function(v,_,p){v.exports=p.p+"assets/img/image-20240306190629633.e12f47c5.png"},606:function(v,_,p){v.exports=p.p+"assets/img/image-20240307155203948.07cef0b0.png"},607:function(v,_,p){v.exports=p.p+"assets/img/image-20240307160148444.6a4c0ab7.png"},608:function(v,_,p){v.exports=p.p+"assets/img/image-20240307160320717.10456409.png"},609:function(v,_,p){v.exports=p.p+"assets/img/image-20240307161049266.71fd4b75.png"},610:function(v,_,p){v.exports=p.p+"assets/img/image-20240307161149387.cc8dc83f.png"},611:function(v,_,p){v.exports=p.p+"assets/img/image-20240307162342568.42854229.png"},612:function(v,_,p){v.exports=p.p+"assets/img/image-20240307162405331.d9806972.png"},613:function(v,_,p){v.exports=p.p+"assets/img/image-20240307163231927.056e28a6.png"},614:function(v,_,p){v.exports=p.p+"assets/img/image-20240307163326942.6ebed5e1.png"},615:function(v,_,p){v.exports=p.p+"assets/img/image-20240307163349505.17de887f.png"},667:function(v,_,p){"use strict";p.r(_);var t=p(14),s=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("h1",{attrs:{id:"ipv4数据报的首部格式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ipv4数据报的首部格式"}},[v._v("#")]),v._v(" IPv4数据报的首部格式")]),v._v(" "),_("p",[v._v("IP数据报的首部格式和内容，是实现IP协议主要功能的基础")]),v._v(" "),_("p",[_("img",{attrs:{src:p(603),alt:"image-20240306184720160"}})]),v._v(" "),_("p",[v._v("如图所示，IP数据报由20字节的"),_("strong",[v._v("固定部分")]),v._v("，和40字节的"),_("strong",[v._v("可变部分")]),v._v("组成")]),v._v(" "),_("p",[v._v("IP数据报的首部 常以32个比特为单位进行描述")]),v._v(" "),_("p",[v._v("图中每一行都由32个比特（4个字节）构成")]),v._v(" "),_("p",[v._v("每个小格子称为字段或者域")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("固定部分（指每个IP数据报首部都必须包含的部分）")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("版本：")]),v._v(" "),_("p",[v._v("占4比特，表示IP协议的版本。")]),v._v(" "),_("p",[v._v("通信双方使用的IP协议版本必须一致，目前广泛使用的版本号为4（IPv4）")])]),v._v(" "),_("li",[_("p",[v._v("首部长度：")]),v._v(" "),_("p",[v._v("占4比特，表示IP数据报首部的长度，该字段的取值以4字节为单位")]),v._v(" "),_("p",[v._v("最小十进制取值为5，表示IP数据报首部只有20字节固定部分")]),v._v(" "),_("p",[v._v("最大十进制取值为15，表示IP数据报首部包含20字节固定部分和最大40字节可变部分")])]),v._v(" "),_("li",[_("p",[v._v("区分服务")]),v._v(" "),_("p",[v._v("占8比特，用来获得更好的服务。")]),v._v(" "),_("p",[v._v("该字段在旧标准中叫作服务类型，但实际上一直没有被使用过。")]),v._v(" "),_("p",[v._v("1998年，因特网工程任务组IETF把这个字段改名为区分服务")]),v._v(" "),_("p",[v._v("利用该字段的不同数值可提供不同等级的服务质量")]),v._v(" "),_("p",[v._v("只有在使用区分服务时，该字段才起作用，一般情况下都不使用该字段")])]),v._v(" "),_("li",[_("p",[v._v("总长度")]),v._v(" "),_("p",[v._v("占16比特，表示IP数据报的总长度（首部+数据载荷）")]),v._v(" "),_("p",[v._v("最大取值为十进制的65535，以字节为单位")]),v._v(" "),_("p",[v._v("通过总长度和首部长度，可以计算出数据载荷长度：")]),v._v(" "),_("p",[_("img",{attrs:{src:p(604),alt:"image-20240306190328568"}})])]),v._v(" "),_("li",[_("p",[v._v("标识、标志、片偏移")]),v._v(" "),_("p",[_("font",{attrs:{color:"#EA0000"}},[v._v("这三个字段共同用于IP数据报分片")])],1),v._v(" "),_("p",[_("img",{attrs:{src:p(605),alt:"image-20240306190629633"}})]),v._v(" "),_("p",[v._v("如图，如果一个IP数据报的长度，超出网络规定的帧的最大数据载荷（例如以太网的1500字节），那么IP数据报就需要被分片，将分片封装成帧")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("标识")]),v._v(" "),_("p",[v._v("占16比特，属于同一个数据报的各分片数据具有相同的标识")]),v._v(" "),_("p",[v._v("IP软件维持一个计数器，每产生一个数据报，计数器值加1，并将此值赋给标识字段")])]),v._v(" "),_("li",[_("p",[v._v("标志")]),v._v(" "),_("p",[v._v("占3比特，各比特含义如下：")]),v._v(" "),_("ul",[_("li",[v._v("DF位：1表示不允许分片，0表示允许分片")]),v._v(" "),_("li",[v._v("MF位：1表示“后面还有分片”，0表示“这是最后一个分片”")]),v._v(" "),_("li",[v._v("保留位：必须为0")])])]),v._v(" "),_("li",[_("p",[v._v("片偏移")]),v._v(" "),_("p",[v._v("占13比特，指出分片数据报的数据载荷部分偏移其在原数据包的位置有多少个单位")]),v._v(" "),_("p",[v._v("片偏移以8个字节为单位")])])]),v._v(" "),_("h5",{attrs:{id:"ip数据报如何分片"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ip数据报如何分片"}},[v._v("#")]),v._v(" IP数据报如何分片")]),v._v(" "),_("p",[v._v("例如，用以太网的数据载荷最大为1500字节，当我们要传输一个有3800字节数据载荷的IPv4数据报（3820字节）时，需要把该IP数据报分片成几个更小的IP数据报，每个长度不能超过1500字节，然后再将每个分片IP数据报封装成一个以太网帧进行传输。")]),v._v(" "),_("p",[_("img",{attrs:{src:p(606),alt:"image-20240307155203948"}})]),v._v(" "),_("p",[v._v("分片完成后，需要给每个分片各添加一个首部，首部以下字段要注意填入不同不内容")]),v._v(" "),_("p",[v._v("标识字段与原IP数据报的标识字段取值相同；片偏移字段取值：该分片数据载荷的第一个字节在原IP数据报数据载荷的位置，除8表示，以8个字节为一个单位。")]),v._v(" "),_("p",[_("img",{attrs:{src:p(607),alt:"image-20240307160148444"}})]),v._v(" "),_("p",[v._v("假定分片2的IP数据报经过某个网络时还需要再进行分片，分为一个800字节，一个600字节，分片后首部如图：")]),v._v(" "),_("p",[_("img",{attrs:{src:p(608),alt:"image-20240307160320717"}})])]),v._v(" "),_("li",[_("p",[v._v("生存时间TTL")]),v._v(" "),_("p",[v._v("占8比特，最初以秒为单位，最大生存周期为255秒，路由器转发IP数据包时，将iP数据报首部中的该字段的值减去IP数据报在本路由器上所耗费的时间，若不为0就转发，否则就丢弃。")]),v._v(" "),_("p",[v._v("现在以“跳数”为单位，路由器转发IP数据报时，将IP数据报首部中的该字段的值减1，若不为0就转发，否则就丢弃。")]),v._v(" "),_("p",[v._v("作用：防止IP数据报在网络中永久兜圈（碰到路由环路）")])]),v._v(" "),_("li",[_("p",[v._v("协议")]),v._v(" "),_("p",[v._v("占8比特，指明IPv4数据报的数据部分是何种协议数据单元。")]),v._v(" "),_("p",[v._v("常用的一些协议和相应的协议字段值如下：")]),v._v(" "),_("p",[_("img",{attrs:{src:p(609),alt:"image-20240307161049266"}})]),v._v(" "),_("p",[v._v("例如，协议字段值为6，数据部分就是TCP报文段")]),v._v(" "),_("p",[_("img",{attrs:{src:p(610),alt:"image-20240307161149387"}})])]),v._v(" "),_("li",[_("p",[v._v("首部检验和")]),v._v(" "),_("p",[v._v("占16比特，用来检测首部在传输过程中是否出现差错，比CRC检验码简单，称为因特网检验和")]),v._v(" "),_("p",[v._v("IP数据报每经过一个路由器，路由器都要重新计算首部检验和，因为某些字段（生存时间、标志、片偏移等）的取值可能发生变化")]),v._v(" "),_("p",[v._v("由于IP层本身并不提供可靠传输的服务，并且计算首部校验和是一项耗时的操作，因此在IPv6中，路由器不再计算首部校验和，从而更快地转发IP数据报。")])]),v._v(" "),_("li",[_("p",[v._v("源IP地址和目的IP地址")]),v._v(" "),_("p",[v._v("各占32比特，用来填写发送该IP数据报的源主机的IP地址和接收该IP数据报的目的主机的IP地址。")])])])]),v._v(" "),_("li",[_("p",[v._v("可变部分")]),v._v(" "),_("ul",[_("li",[_("p",[v._v("可选字段")]),v._v(" "),_("p",[v._v("长度从1个字节到40个字节不等，用来支持排错、测量及安全等措施。")]),v._v(" "),_("p",[v._v("可选字段增加了IP数据报的功能，但这同时也使得IP数据报的首部长度为可变的。这就增加了每一个路由器处理IP数据报的开销，实际上可选字段很少被使用")])]),v._v(" "),_("li",[_("p",[v._v("填充字段")]),v._v(" "),_("p",[v._v("确保整个首部长度为4字节的整数倍，使用全0进行填充")])])])])]),v._v(" "),_("h2",{attrs:{id:"考研题"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#考研题"}},[v._v("#")]),v._v(" 考研题")]),v._v(" "),_("p",[_("img",{attrs:{src:p(611),alt:"image-20240307162342568"}})]),v._v(" "),_("p",[_("img",{attrs:{src:p(612),alt:"image-20240307162405331"}})]),v._v(" "),_("hr"),v._v(" "),_("p",[_("img",{attrs:{src:p(613),alt:"image-20240307163231927"}})]),v._v(" "),_("p",[_("img",{attrs:{src:p(614),alt:"image-20240307163326942"}})]),v._v(" "),_("p",[_("img",{attrs:{src:p(615),alt:"image-20240307163349505"}})])])}),[],!1,null,null,null);_.default=s.exports}}]);